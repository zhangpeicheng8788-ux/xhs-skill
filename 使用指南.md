# Auto-Redbook Skill V6.6 - 完整使用指南

## 📦 Skill 目录结构

```
Auto-Redbook-Skills-main/
├── 📄 启动文件（双击运行）
│   ├── start_publish.bat          # 批量发布工具
│   ├── view_progress.bat          # 进度查看器
│   └── test_environment.bat       # 环境测试工具
│
├── 📁 scripts/                    # Python 脚本
│   ├── publish_gui.py             # 批量发布 GUI 主程序
│   ├── progress_viewer_gui.py     # 进度查看器 GUI 主程序
│   ├── batch_publish_xhs_with_log.py  # 带日志的批量发布
│   ├── validate_cookie.py         # Cookie 验证工具
│   ├── render_xhs_v2.py          # 图片渲染脚本 V2
│   ├── publish_xhs.py            # 单篇发布脚本
│   └── login_xhs.py              # 登录脚本
│
├── 📁 assets/                     # 资源文件
│   ├── cover.html                # 封面模板
│   ├── card.html                 # 卡片模板
│   ├── styles.css                # 样式文件
│   └── example.md                # 示例 Markdown
│
├── 📁 docs/                       # 文档目录
│   ├── 快速使用指南.md
│   ├── GUI工具使用说明.md
│   ├── Cookie获取指南.md
│   └── 常见问题解答.md
│
├── 📄 配置文件
│   ├── .env                      # Cookie 配置（需自行创建）
│   ├── env.example.txt           # 配置示例
│   └── publish_records.json      # 发布记录（自动生成）
│
└── 📄 说明文档
    ├── README.md                 # 项目说明
    ├── SKILL.md                  # 技能文档
    ├── CHANGELOG_V6.6.md         # 版本说明
    └── QUICKSTART.md             # 快速开始
```

---

## 🚀 快速开始（3步上手）

### 步骤1：测试环境
```
双击运行: test_environment.bat
```
- 检查 Python 是否安装
- 检查依赖是否完整
- 自动安装缺失依赖

### 步骤2：配置 Cookie
1. 参考 `docs/Cookie获取指南.md`
2. 获取小红书 Cookie
3. 创建 `.env` 文件，添加：
   ```
   XHS_COOKIE=你的Cookie字符串
   ```

### 步骤3：开始发布
```
双击运行: start_publish.bat
```
- 点击"开始发布"按钮
- 等待任务完成
- 查看发布结果

---

## 🎨 工具说明

### 1. 批量发布工具（start_publish.bat）

**功能**:
- ✅ 图形界面，操作简单
- ✅ 实时显示发布进度
- ✅ 支持暂停/继续/停止
- ✅ 自动倒计时显示
- ✅ 不会超时，稳定运行

**使用场景**:
- 批量发布多篇笔记
- 自动间隔发布
- 实时监控发布过程

**界面说明**:
```
┌──────────────────────────────────────┐
│ 小红书笔记批量发布工具 (红色标题栏)   │
├──────────────────────────────────────┤
│ 笔记目录: D:\...                      │
│ 起始笔记: note_01 | 间隔: 10分钟      │
├──────────────────────────────────────┤
│ 发布进度: 3/10 篇已完成               │
├──────────────────────────────────────┤
│ 发布日志: (实时输出)                  │
├──────────────────────────────────────┤
│ [开始发布] [暂停] [停止]      [退出] │
└──────────────────────────────────────┘
```

---

### 2. 进度查看器（view_progress.bat）

**功能**:
- ✅ 显示已发布笔记列表
- ✅ 显示发布进度统计
- ✅ 双击打开笔记链接
- ✅ 自动刷新（每5秒）
- ✅ 快速打开创作者中心

**使用场景**:
- 查看发布进度
- 查看已发布笔记
- 快速访问笔记链接

**界面说明**:
```
┌──────────────────────────────────────┐
│ 小红书笔记发布进度查看器              │
├──────────────────────────────────────┤
│ 已发布: 3 / 10 篇                     │
│ 最后更新: 2026-01-27 20:00:00        │
├──────────────────────────────────────┤
│ 笔记列表表格 (可双击打开链接)         │
├──────────────────────────────────────┤
│ [刷新] [打开创作者中心]        [退出] │
└──────────────────────────────────────┘
```

---

### 3. 环境测试工具（test_environment.bat）

**功能**:
- ✅ 检查 Python 安装
- ✅ 检查脚本语法
- ✅ 检查依赖安装
- ✅ 自动安装缺失依赖

**使用场景**:
- 首次使用前测试
- 遇到问题时诊断
- 更新依赖后验证

---

## 📖 详细文档

### 文档列表

| 文档名称 | 说明 |
|---------|------|
| `快速使用指南.md` | 快速上手指南 |
| `GUI工具使用说明.md` | 详细使用说明 |
| `Cookie获取指南.md` | Cookie 获取方法 |
| `常见问题解答.md` | 常见问题和解决方案 |
| `SKILL.md` | 完整技能文档 |
| `CHANGELOG_V6.6.md` | 版本更新说明 |

### 查看文档

所有文档位于：
- 主目录：`D:\20260127XHS\Auto-Redbook-Skills-main\`
- 文档目录：`D:\20260127XHS\Auto-Redbook-Skills-main\docs\`

---

## ⚙️ 配置说明

### 必需配置

#### 1. Cookie 配置

**文件**: `.env`

**内容**:
```
XHS_COOKIE=你的完整Cookie字符串
```

**获取方法**:
1. 访问 https://creator.xiaohongshu.com
2. 登录账号
3. 按 F12 打开开发者工具
4. Network → 任意请求 → Headers → Cookie
5. 复制完整 Cookie 字符串
6. 粘贴到 `.env` 文件

**详细说明**: 参考 `docs/Cookie获取指南.md`

### 可选配置

#### 2. 发布参数配置

**文件**: `start_publish.bat`

**可修改参数**:
```batch
--start-from 1        # 从第几篇开始（1-10）
--wait-minutes 10     # 发布间隔（分钟）
```

**修改方法**:
1. 右键编辑 `start_publish.bat`
2. 修改参数值
3. 保存文件

---

## 🎯 使用流程

### 完整流程（从创作到发布）

#### 第1步：创作笔记内容
1. 确定笔记数量和主题
2. 撰写小红书风格内容
3. 生成 Markdown 文件

#### 第2步：渲染图片卡片
```bash
# 使用 V2 渲染脚本
python scripts/render_xhs_v2.py note_1/note_1.md -o note_1 --style purple
python scripts/render_xhs_v2.py note_2/note_2.md -o note_2 --style xiaohongshu
```

#### 第3步：配置 Cookie
1. 获取小红书 Cookie
2. 创建 `.env` 文件
3. 配置 Cookie

#### 第4步：测试环境
```
双击运行: test_environment.bat
```

#### 第5步：批量发布
```
双击运行: start_publish.bat
```

#### 第6步：查看进度
```
双击运行: view_progress.bat
```

---

## ⚠️ 注意事项

### 1. 环境要求
- Windows 操作系统
- Python 3.14（安装在 `C:\Python314\`）
- 依赖库：xhs, python-dotenv

### 2. Cookie 管理
- Cookie 会过期，需定期更新
- 失效后重新获取即可
- 不要分享 Cookie 给他人

### 3. 发布规则
- 默认间隔：10分钟/篇
- 不建议设置太短
- 避免频繁发布被限流

### 4. 窗口管理
- 发布时不要关闭窗口
- 可以最小化
- 关闭会中断任务

### 5. 网络要求
- 确保网络稳定
- 上传图片需要时间
- 不要在发布时断网

---

## 🐛 故障排查

### 问题1：双击后没反应
**解决方案**:
1. 等待几秒（程序启动需要时间）
2. 检查 Python 路径是否正确
3. 运行 `test_environment.bat` 检查环境

### 问题2：提示"未找到 Cookie"
**解决方案**:
1. 检查 `.env` 文件是否存在
2. 检查 Cookie 格式是否正确
3. 重新获取 Cookie

### 问题3：发布失败
**解决方案**:
1. 查看日志中的错误信息
2. 检查 Cookie 是否失效
3. 检查网络连接
4. 重新启动程序

### 问题4：进度查看器无数据
**解决方案**:
1. 等待第一篇笔记发布完成
2. 检查 `publish_records.json` 是否存在
3. 手动刷新

---

## 📞 获取帮助

### 文档资源
- `README.md` - 项目说明
- `SKILL.md` - 完整技能文档
- `docs/` - 详细文档目录

### 常见问题
- `docs/常见问题解答.md` - FAQ

### 版本信息
- `CHANGELOG_V6.6.md` - 版本更新说明

---

## 🎉 开始使用

### 推荐流程

**首次使用**:
1. 运行 `test_environment.bat` 测试环境
2. 配置 `.env` 文件（Cookie）
3. 运行 `start_publish.bat` 开始发布

**日常使用**:
1. 准备好笔记内容和图片
2. 运行 `start_publish.bat`
3. 运行 `view_progress.bat` 查看进度

**遇到问题**:
1. 查看 `docs/常见问题解答.md`
2. 运行 `test_environment.bat` 诊断
3. 查看日志文件排查错误

---

**Skill 版本**: V6.6
**最后更新**: 2026-01-27
**维护者**: StepFun AI Team
