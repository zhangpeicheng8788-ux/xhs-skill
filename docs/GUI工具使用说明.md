# 小红书笔记批量发布工具 - 使用说明（GUI版本）

## ✅ 问题已修复

已修复批处理文件闪退的问题。现在使用**图形界面（GUI）**，操作更简单直观。

---

## 🎨 新工具介绍

### 1. 批量发布工具（GUI版本）⭐⭐⭐

**文件**: `启动发布工具.bat`

**特点**:
- ✅ 图形界面，操作简单
- ✅ 实时显示发布进度
- ✅ 支持暂停/继续/停止
- ✅ 不会闪退，稳定运行
- ✅ 自动保存发布记录

**界面功能**:
- 📊 实时进度显示
- 📝 详细日志输出
- ⏸️ 暂停/继续按钮
- ⏹️ 停止按钮
- 🔄 自动倒计时

**使用方法**:
```
双击运行: D:\jieyue_work\drivingschool_notes\启动发布工具.bat
```

**操作步骤**:
1. 双击 `启动发布工具.bat`
2. 等待窗口打开（红色标题栏）
3. 点击"开始发布"按钮
4. 等待任务完成（可随时暂停或停止）
5. 完成后会弹出提示框

---

### 2. 进度查看器（GUI版本）⭐⭐⭐

**文件**: `查看发布进度.bat`

**特点**:
- ✅ 图形界面，清晰直观
- ✅ 显示已发布笔记列表
- ✅ 显示笔记标题、时间
- ✅ 双击打开笔记链接
- ✅ 自动刷新（每5秒）

**界面功能**:
- 📊 进度统计（X / 10 篇）
- 📋 笔记列表表格
- 🔗 双击打开笔记
- 🔄 自动刷新
- 🌐 快速打开创作者中心

**使用方法**:
```
双击运行: D:\jieyue_work\drivingschool_notes\查看发布进度.bat
```

**操作说明**:
- 双击表格中的笔记可以打开笔记链接
- 点击"刷新"按钮手动刷新
- 点击"打开创作者中心"快速访问小红书

---

## 🚀 推荐使用流程

### 方案A：简单使用（推荐）

1. **启动发布工具**
   - 双击 `启动发布工具.bat`
   - 等待窗口打开

2. **开始发布**
   - 点击"开始发布"按钮
   - 观察日志输出

3. **等待完成**
   - 任务会自动运行
   - 可以最小化窗口，不影响运行
   - 完成后会弹出提示

### 方案B：同时监控（推荐）

1. **打开发布工具**
   - 双击 `启动发布工具.bat`
   - 点击"开始发布"

2. **打开进度查看器**
   - 双击 `查看发布进度.bat`
   - 实时查看已发布笔记

3. **同时运行**
   - 两个窗口可以同时打开
   - 一个显示发布过程
   - 一个显示发布结果

---

## 📸 界面预览

### 批量发布工具界面

```
┌─────────────────────────────────────────────┐
│  小红书笔记批量发布工具                      │  (红色标题栏)
├─────────────────────────────────────────────┤
│  笔记目录: D:\jieyue_work\drivingschool_notes│
│  起始笔记: note_01  |  发布间隔: 10 分钟/篇   │
├─────────────────────────────────────────────┤
│  发布进度: 3/10 篇已完成                     │
├─────────────────────────────────────────────┤
│  发布日志:                                   │
│  ┌───────────────────────────────────────┐  │
│  │ [19:45:23] 开始批量发布任务           │  │
│  │ [19:45:24] 正在加载 Cookie...         │  │
│  │ [19:45:25] 正在创建小红书客户端...    │  │
│  │ [19:45:26] 找到 10 篇笔记待发布       │  │
│  │ [19:45:27] [1/10] 处理 note_01        │  │
│  │ [19:45:28] 标题: 3280元学车！...      │  │
│  │ [19:45:29] 图片数量: 23               │  │
│  │ [19:45:30] 正在上传图片...            │  │
│  │ [19:46:15] 发布成功！                 │  │
│  │ [19:46:16] 笔记ID: 6978a7ec...        │  │
│  │ [19:46:17] 等待 10 分钟后发布下一篇... │  │
│  └───────────────────────────────────────┘  │
├─────────────────────────────────────────────┤
│ [开始发布] [暂停] [停止]            [退出]  │
└─────────────────────────────────────────────┘
```

### 进度查看器界面

```
┌─────────────────────────────────────────────────────┐
│  小红书笔记发布进度查看器                            │  (红色标题栏)
├─────────────────────────────────────────────────────┤
│  已发布: 3 / 10 篇                                   │
│  最后更新: 2026-01-27 19:50:00                       │
├─────────────────────────────────────────────────────┤
│  已发布笔记列表:                                     │
│  ┌───┬────────┬──────────────┬─────────┬────────┐  │
│  │序号│笔记名称│    标题      │发布时间 │ 操作   │  │
│  ├───┼────────┼──────────────┼─────────┼────────┤  │
│  │ 1 │note_01 │3280元学车！...│19:45    │查看笔记│  │
│  │ 2 │note_02 │35天拿证！...  │19:56    │查看笔记│  │
│  │ 3 │note_03 │0首付就能学车？│20:07    │查看笔记│  │
│  └───┴────────┴──────────────┴─────────┴────────┘  │
├─────────────────────────────────────────────────────┤
│ [刷新] [打开创作者中心]                      [退出] │
└─────────────────────────────────────────────────────┘
```

---

## ⚙️ 高级设置

### 修改发布参数

如果需要修改起始笔记或发布间隔，可以编辑 `启动发布工具.bat` 文件：

```batch
@echo off
cd /d "D:\20260127XHS\Auto-Redbook-Skills-main"
C:\Python314\python.exe scripts\publish_gui.py ^
    --notes-dir "D:\jieyue_work\drivingschool_notes" ^
    --start-from 1 ^
    --wait-minutes 10

pause
```

**参数说明**:
- `--start-from 1`: 从第1篇开始（可改为 2, 3, 4...）
- `--wait-minutes 10`: 间隔10分钟（可改为 5, 15, 20...）

**示例**:
```batch
# 从第5篇开始，间隔5分钟
--start-from 5 --wait-minutes 5
```

---

## 📋 功能说明

### 批量发布工具功能

| 功能 | 说明 |
|------|------|
| 开始发布 | 启动批量发布任务 |
| 暂停 | 暂停当前任务（可继续） |
| 停止 | 完全停止任务 |
| 退出 | 关闭程序 |
| 实时日志 | 显示详细发布过程 |
| 进度显示 | 显示当前进度和剩余时间 |

### 进度查看器功能

| 功能 | 说明 |
|------|------|
| 自动刷新 | 每5秒自动更新数据 |
| 手动刷新 | 点击按钮立即刷新 |
| 双击打开 | 双击笔记打开链接 |
| 快速访问 | 一键打开创作者中心 |
| 进度统计 | 显示已发布数量 |

---

## ⚠️ 注意事项

### 1. 窗口不要关闭

- 发布过程中不要关闭发布工具窗口
- 可以最小化，但不要关闭
- 关闭窗口会中断发布任务

### 2. Cookie 有效期

- Cookie 可能在几小时到几天后失效
- 如果提示"无登录信息"，需要重新获取 Cookie
- 参考 `Cookie获取指南.md` 重新获取

### 3. 网络连接

- 确保网络连接稳定
- 上传图片需要时间
- 不要在发布过程中断网

### 4. 暂停和继续

- 暂停后可以随时继续
- 暂停不会丢失进度
- 停止后需要重新开始

---

## 🐛 故障排查

### 问题1: 双击后没有反应

**可能原因**:
- Python 路径不正确
- 缺少依赖库

**解决方案**:
1. 检查 Python 是否安装在 `C:\Python314\`
2. 运行以下命令安装依赖:
   ```
   C:\Python314\python.exe -m pip install xhs python-dotenv
   ```

### 问题2: 提示"未找到 Cookie"

**解决方案**:
1. 检查 `.env` 文件是否存在
2. 检查 `XHS_COOKIE` 是否配置正确
3. 参考 `Cookie获取指南.md` 重新获取

### 问题3: 发布失败

**解决方案**:
1. 查看日志中的错误信息
2. 检查 Cookie 是否失效
3. 检查网络连接
4. 重新启动程序

### 问题4: 进度查看器显示"暂无发布记录"

**可能原因**:
- 还没有开始发布
- 发布记录文件不存在

**解决方案**:
- 等待第一篇笔记发布完成
- 或者先运行发布工具

---

## 📊 发布记录

发布记录保存在:
```
D:\20260127XHS\Auto-Redbook-Skills-main\publish_records.json
```

格式示例:
```json
{
  "note_01": {
    "note_id": "6978a7ec000000002202146a",
    "title": "3280元学车！德安驾校真的太良心了",
    "published_at": "2026-01-27T19:45:30",
    "url": "https://www.xiaohongshu.com/explore/6978a7ec000000002202146a"
  }
}
```

---

## 🎉 使用建议

1. **首次使用**:
   - 先运行"查看发布进度"确认没有已发布的笔记
   - 然后运行"启动发布工具"开始发布

2. **监控进度**:
   - 同时打开两个工具
   - 一个看发布过程，一个看发布结果

3. **中途中断**:
   - 如果需要中断，点击"停止"按钮
   - 下次可以修改 `--start-from` 参数继续

4. **完成后**:
   - 访问创作者中心确认所有笔记
   - 检查笔记的审核状态
   - 查看数据表现

---

**最后更新**: 2026-01-27 20:15
**版本**: 3.0 - GUI 图形界面版本
